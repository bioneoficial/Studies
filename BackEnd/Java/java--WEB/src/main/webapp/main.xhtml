<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
	<title>Cadastro de Pessoas</title>
</h:head>
<h:body>
	<div id="cabecalho">
		<h1>
			#{helloWorldController.helloWorldPhrase}
		</h1>
	</div>

	<h:form id="formCadastro">
	<div id="conteudo">
		<h4>Cadastro de pessoa</h4>

		<!--@elvariable id="PessoaBean" type="br.senai.sc.controller.PessoaBean"-->
		<h:outputText value="Nome:" />
		<h:inputText id="nome" value="#{PessoaBean.nome}" required="true" validator="#{PessoaBean.validateName}" placeholder="nome">
			<f:validateLength minimum="3" />
			<h:message for="nome" />
		</h:inputText>
		<h:outputText value="Data nascimento:" />
		<h:inputText id="nascimento" value="#{PessoaBean.nascimento}" placeholder="Nascimento">
			<f:convertDateTime pattern="dd/MM/yyyy" />
			<f:validator validatorId="dateValidator" />
			<h:message for="nascimento" />
		</h:inputText>
		<h:outputText value="CPF:" />
		<h:inputText id="cpf" value="#{PessoaBean.cpf}">
			<f:validateRegex pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" />
			<f:validator validatorId="cpfValidator" />
			<h:message for="cpf" />
		</h:inputText>
		<h:outputText value="E-mail:" />
		<h:inputText id="email" value="#{PessoaBean.email}">
			<f:validateRegex pattern="^[_A-Za-z0-9-]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
			<h:message for="email" />
		</h:inputText>

		<fieldset>
			<legend>Endereço</legend>
			<h:outputText value="CEP:" />
			<p:inputMask id="cep" placeholder="CEP" value="#{PessoaBean.cep}" mask="99999-999">
				<p:ajax event="blur" listener="#{PessoaBean.preencherEndereco}" update="rua cidade estado" />
			</p:inputMask>
			<p:commandButton icon="ui-icon-search" actionListener="#{PessoaBean.preencherEndereco}" update="formCadastro:rua formCadastro:cidade formCadastro:estado" />
			<h:outputText value="Rua:" />
			<p:inputText id="rua"  value="#{PessoaBean.rua}" placeholder="Rua" />
			<h:outputText value="Número:" />
			<p:inputNumber id="numero"  value="#{PessoaBean.numero}" placeholder="Número" />
			<h:outputText value="Cidade:" />
			<p:inputText id="cidade" value="#{PessoaBean.cidade}" placeholder="Cidade" />
			<h:outputText value="Estado:" />
			<p:inputText id="estado" value="#{PessoaBean.estado}" placeholder="Estado" />
		</fieldset>
		<p:commandButton  id="btnSalvar" value="Salvar" action="#{PessoaBean.salvar}" />

		<fieldset>
		<p:dataTable id="pessoasTable" var="pessoa" value="#{PessoaBean}">
			<legend>Pessoas Cadastradas</legend>
			<p:column headerText="Nome">
				<h:outputText value="#{pessoa.nome}" />
			</p:column>
			<p:column headerText="Nascimento">
				<h:outputText value="#{pessoa.nascimento}">
					<f:convertDateTime pattern="dd/MM/yyyy" />
				</h:outputText>
			</p:column>
			<p:column headerText="CPF">
				<h:outputText value="#{pessoa.cpf}" />
			</p:column>
			<p:column headerText="Cidade">
				<h:outputText value="#{pessoa.cidade}/#{pessoa.estado}" />
			</p:column>
			<p:column headerText="Situação de Integração">
				<h:outputText value="#{pessoa.situacaoIntegracao}" />
			</p:column>
			<p:column headerText="Ação">
				<p:commandButton icon="ui-icon-pencil" action="#{PessoaBean.editar}" update="formCadastro" />
				<p:commandButton icon="ui-icon-arrowrefresh-1-w" action="#{PessoaBean.atualizar}" update="formCadastro" />
				<p:commandButton icon="ui-icon-trash" action="#{PessoaBean.excluir}" update="formCadastro" />
			</p:column>
		</p:dataTable>
		</fieldset>
	</div>

	<div>
		<fieldset>
	<legend>Consultar Pessoas integradas</legend>
	<p:inputMask id="cpfConsulta" placeholder="CPF" mask="999.999.999-99" />
	<p:commandButton value="Consultar" action="#{PessoaBean.consultar}" />

	<h:panelGrid columns="2">
		<h:outputText value="Nome:" />
		<h:outputText value="#{PessoaBean.nome}" />

		<h:outputText value="Nascimento:" />
		<h:outputText value="#{PessoaBean.nascimento}">
			<f:convertDateTime pattern="dd/MM/yyyy" />
		</h:outputText>

		<h:outputText value="Situação da Integração:" />
		<h:outputText value="#{PessoaBean.situacaoIntegracao}" />

		<h:outputText value="Data/Hora da Inclusão:" />
		<h:outputText value="#{PessoaBean.dataHoraInclusaoRegistro}" />

		<h:outputText value="Data/Hora da Última Alteração:" />
		<h:outputText value="#{PessoaBean.dataHoraUltimaAlteracaoRegistro}" />
	</h:panelGrid>
		</fieldset>
	</div>

	</h:form>

</h:body>

</html>